section .data
	hello : db "Hello world",10,0
	helen : equ $-hello
	var1 : dq 0x1234567990abcdef
	var2 : dq 0xabcdef0123456789

section .bss
	copy : resb helen	
	var3 : resb 8
	

section .text

global _start

func:
	push rbp
	mov rbp,rsp

	mov rax,1
	mov rdi,1
	mov rsi,[rsp + 16]
	mov rdx,[rsp + 24]
	syscall

	mov rsp,rbp
	pop rbp
	ret

exit:
	xor rax,rax
	mov al,60
	xor rdi,rdi
	syscall

_start:

	mov ecx,helen
	cld
	lea rsi,[hello]
	lea rdi,[copy]
	rep movsb

	mov ecx,helen

	lea rsi,[copy]
	lea rdi,[hello]
	
	add rsi,helen
	sub rsi,3

looping:
	std
	lodsb
	cld
	stosb
loop looping
	
	push helen
	push hello
	call func	

	mov rax,[var2]
	lea rdi,[var3]
	stosq

	lea rsi,[var3]
	lodsq

	call exit 
